// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id        Int       @id @default(autoincrement())
    username  String    @unique
    password  String
    createdAt DateTime  @default(now())
    account   Account[]
    Session   Session?
}

model Session {
    id        Int      @id @default(autoincrement())
    User      User     @relation(fields: [userId], references: [id])
    userId    Int      @unique
    key       String
    maxAge    String
    createdAt DateTime @default(now())
    updatedAt DateTime
}

model Account {
    id            Int           @id @default(autoincrement())
    User          User          @relation(fields: [userId], references: [id])
    userId        Int
    twitterUser   TwitterUser   @relation(fields: [twitterUserId], references: [id])
    twitterUserId BigInt
    tweet         Tweet[]
    TwitterOAuth  TwitterOAuth?
}

model TwitterUser {
    id              BigInt    @id @unique
    name            String
    screenName      String
    profileImageUrl String
    Account         Account[]
    Tweet           Tweet[]
}

model Tweet {
    id               Int         @id @default(autoincrement())
    account          Account     @relation(fields: [accountId], references: [id])
    accountId        Int
    twitterUser      TwitterUser @relation(fields: [twitterUserId], references: [id])
    twitterUserId    BigInt
    createdAt        DateTime    @default(now())
    updatedAt        DateTime?
    scheduledTimeUTC DateTime    @db.Timestamptz(3)
    content          String      @db.VarChar(280)
    sent             Boolean     @default(false)
    Image            Image[]
}

model Image {
    id      Int     @id @default(autoincrement())
    tweet   Tweet   @relation(fields: [tweetId], references: [id])
    tweetId Int
    name    String  @unique
    path    String // local path until uploaded to twitter
    alt     String?
}

model TwitterOAuth {
    account      Account   @relation(fields: [accountId], references: [id])
    accountId    Int       @id @unique
    accessToken  String
    accessSecret String
    createdAt    DateTime  @default(now())
    updatedAt    DateTime?
}

model Paper {
    id            Int      @id @default(autoincrement())
    type          String
    title         String
    authors       String[]
    fullAuthors   String?
    doi           String   @unique
    url           String
    preprint      String?
    shortAbstract String
    fullAbstract  String?
    monthYear     String?
    pages         String?
    citations     Int?
    downloads     Int?
}
